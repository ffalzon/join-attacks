\section{MKPC Supplementary Content}\label{ap:mkpc}

\begin{figure}[H]
	\begin{pchstack}[boxed, center]
		\procedure[linenumbering, skipfirstln]{$\match(X, Y)$}{ 
			\pclinecomment{Recall that $X = \{\bx_1, \dots, \bx_n\}, Y = \{\by_1, \dots, \by_n\}$} \\
			\text{Initialize empty maps $\MX$ and $\MY$.} \\
			\text{Initialize empty set $\UID$.} \\
			\mathsf{matched}^{X} \gets (\bot)^n; \; \mathsf{matched}^{Y} \gets (\bot)^m \\
			n_{max} \gets \max_{\bx\in X} |\bx | \pcskipln\\
			\pclinecomment{Match Records} \\
			\pcfor j = 1, \dots, n_{max} \pcdo \\
			\t	\pcfor k = 1, \dots, m \pcdo \label{lin:match_loop_V}\\
			\t	\t 	\pcif \mathsf{matched}^{Y}[k] = \top \pcthen \pccontinue \\
			\t	\t	\pcfor i = 1, \dots, n \pcdo \\
			\t	\t	\t	\pcif \mathsf{matched}^X[i] = \top \lor |\bx_i| < j \pcthen \pccontinue\\
			\t	\t	\t	\pcfor \ell = 1, \dots, |\by_i| \pcdo \\
			\t	\t	\t	\t	\pcif \bx_i[j] = \by_k[\ell] \pcthen \label{lin:match_common_uid} \\
			\t	\t	\t	\t	\t	\uid \sample \calG \setminus \UID \\
			\t	\t	\t	\t	\t	\UID \gets \UID \cup \{\uid\} \\
			\t	\t	\t	\t	\t	\MX[\uid] \gets \bx_i \\
			\t	\t	\t	\t	\t	\MY[\uid] \gets \by_k \\
			\t	\t	\t	\t	\t	\mathsf{matched}^X[i] \gets \top; \;\mathsf{matched}^Y[k] \gets \top \pcskipln\\
			\pclinecomment{Assign uids to unmatched records} \\
			\pcfor i = 1, \dots, n \\
			\t 	\pcif \mathsf{matched}^X[i] = \bot \pcthen \label{lin:match_unmatched_C_uid} \\
			\t	\t	\uid \sample \calG \setminus \UID \\
			\t	\t	\UID \gets \UID \cup \{\uid\} \\
			\t	\t	\MX[\uid] \gets \bx_i \\
			\t	\t	\MY[\uid] \gets \bot \\
			\pcfor i = 1, \dots, m \\
			\t 	\pcif \mathsf{matched}^Y[i] = \bot \pcthen \label{lin:match_unmatched_P_uid} \\
			\t	\t	\uid \sample \calG \setminus \UID \\
			\t	\t	\UID \gets \UID \cup \{\uid\} \\
			\t	\t	\MX[\uid] \gets \bot \\
			\t	\t	\MY[\uid] \gets \by_i \\
			\pcreturn \UID, \MX, \MY
		}
	\end{pchstack}
	\caption{Record matching logic used in MK-PrivateID. \label{fig:match_logic}}
\end{figure}
